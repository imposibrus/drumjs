!function(){function t(t,i){if(this.element=t,this.settings=this._mergeSettings(i),this.transformProp=this._getTransformProperty(),this._render(),this.settings.interactive){"undefined"!=typeof Hammer&&e?this._configureHammer():this._configureEvents()}this.setIndex(this.settings.index)}var e="ontouchstart"in window||navigator.msMaxTouchPoints>0;t.prototype={setIndex:function(t){var e=this.settings.data.length;t>e?t%=e:t<0&&(t=e-Math.abs(t)%e),this.index=t,this.updateDisplay()},getIndex:function(){return this.index},updateDisplay:function(){for(var t=this._getVisibleItems(this.index),e=this.drum.children,i=e.length,n=0;n<i;n++)this._updateDrumItem(e[n],t[n])},_mergeSettings:function(t){t=t||{};var e,i={radius:75,wedgeHeight:30,rotateFn:"rotateX",interactive:!0,dial_w:20,dial_h:5,dial_stroke_color:"#999999",dial_stroke_width:1,index:this.element.selectedIndex};for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i.data=i.data||this._getDataFromChildren(),"number"!=typeof i.index&&(i.index=0),i},_getDataFromChildren:function(){for(var t=[],e=0;e<this.element.children.length;e++){var i=this.element.children[e];t.push({value:i,label:i.textContent})}return t},_getTransformProperty:function(){for(var t=!1,e="transform WebkitTransform MozTransform OTransform msTransform".split(" "),i=0;i<e.length;i++)void 0!==document.createElement("div").style[e[i]]&&(t=e[i]);return t||"transform"},_render:function(){var e,i,n,s,r,a;this.element.style.display="none",this.wrapper=e=document.createElement("div"),e.classList.add("drum-wrapper"),this.settings.id?e.setAttribute("id",this.settings.id):this.element.id?e.setAttribute("id","drum_"+this.element.id):this.element.hasAttribute("name")&&e.setAttribute("id","drum_"+this.element.getAttribute("name")),this.inner=i=document.createElement("div"),i.classList.add("inner"),e.appendChild(i),this.container=n=document.createElement("div"),n.classList.add("container"),i.appendChild(n),this.drum=a=document.createElement("div"),a.classList.add("drum"),n.appendChild(a),!0===this.settings.interactive&&(this.dialUp=s=t.DrumIcon.up(this.settings),e.appendChild(s),this.dialDown=r=t.DrumIcon.down(this.settings),e.appendChild(r)),this.element.parentNode.insertBefore(e,this.element.nextSibling);for(var d=this._calculateTotalWedges(),o=0;o<d;o++){var h=document.createElement("div");h.classList.add("drum-item"),a.appendChild(h)}this._applyTransformations()},_calculateTotalWedges:function(){var t=this.settings.radius,e=this.settings.wedgeHeight,i=2*Math.PI/(e/t);return Math.max(1,Math.floor(i))},_getVisibleItems:function(t){var e,i=[],n=this.drum.children.length,s=Math.floor(n/2);for(e=0;e<s;e++)i.push(this._getItem(e+t));for(e=s;e>0;e--)i.push(this._getItem(t-e));return i},_getItem:function(t){var e=this.settings.data.length;return t<0?t=e+t:t>=e&&(t-=e),this.settings.data[t]},_updateDrumItem:function(t,e){t.textContent=e.label},_getDrumTransformation:function(t,e,i){return"translateZ(-"+t+"px) "+e+"("+i+"deg)"},_getItemTransformation:function(t,e,i){return e+"("+i+"deg) translateZ(-"+t+"px) "},_applyTransformations:function(){this.drum.style[this.transformProp]=this._getDrumTransformation(this.settings.radius,this.settings.rotateFn,0);for(var t=this.drum.children.length,e=360/t,i=0;i<t;i++){this.drum.children[i].style[this.transformProp]=this._getItemTransformation(this.settings.radius,this.settings.rotateFn,i*e)}},_transform:function(t){},_configureHammer:function(){var t=new Hammer.Pan({direction:Hammer.DIRECTION_VERTICAL}),e=new Hammer.Manager(this.drum);e.add(t);var i=0;e.on("pan",function(t){var e=Math.floor((t.distance-i)/this.settings.wedgeHeight);if(e>0){i=t.distance;var n=this.index+(t.velocity>0?-e:e);this.setIndex(n)}t.isFinal&&(i=0)}.bind(this))},_configureEvents:function(){this.dialUp.addEventListener("click",function(){this.setIndex(this.getIndex()-1)}.bind(this)),this.dialDown.addEventListener("click",function(){this.setIndex(this.getIndex()+1)}.bind(this)),this.wrapper.addEventListener("mouseover",function(){this.dialUp.style.display="block",this.dialDown.style.display="block"}.bind(this)),this.wrapper.addEventListener("mouseout",function(){this.dialUp.style.display="none",this.dialDown.style.display="none"}.bind(this)),this.wrapper.addEventListener("wheel",function(t){var e=this.index+(t.wheelDelta<0?-1:1);this.setIndex(e)}.bind(this))}},this.Drum=t}(),function(){var t=function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},e=function(e,i){var n=t("svg");n.setAttribute("width",e),n.setAttribute("height",i);var s=t("g");return n.appendChild(s),n},i=function(t){var e=document.createElement("div");e.setAttribute("class",t);var i=document.createElement("div");return e.appendChild(i),e},n=function(e){var i=t("path"),n={fill:"none",stroke:e.dial_stroke_color,"stroke-width":e.dial_stroke_width+"px","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-opacity":"1"};for(var s in n)i.setAttribute(s,n[s]);return i};this.Drum.DrumIcon={up:function(t){var s=t.dial_w,r=t.dial_h,a=e(s,r),d=n(t);d.setAttribute("d","m0,"+(r+t.dial_stroke_width)+"l"+s/2+",-"+r+"l"+s/2+","+r),a.firstChild.appendChild(d);var o=i("dial up");return o.firstChild.appendChild(a),o},down:function(t){var s=t.dial_w,r=t.dial_h,a=e(s,r),d=n(t);d.setAttribute("d","m0,-"+t.dial_stroke_width+"l"+s/2+","+r+"l"+s/2+",-"+r),a.firstChild.appendChild(d);var o=i("dial down");return o.firstChild.appendChild(a),o}}}();